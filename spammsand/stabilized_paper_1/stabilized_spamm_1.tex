%% LyX 2.1.1 created this file.  For more info, see http://www.lyx.org/.
%% Do not edit unless you really know what you are doing.
%\documentclass[letterpaper,twocol,amsmath,aps,jcp,preprintnumbers,groupaddress,nofootinbib,tightenlines]{revtex4-1}
%\usepackage[latin9]{inputenc}
%\usepackage{textcomp}

\documentclass[letterpaper,twocolumn,amsmath,amsfont,amssymb,english,aps,jcp,preprintnumbers,groupaddress,nofootinbib,tightenlines]{revtex4}

%\documentclass[aps,prb,letterpaper,twocolumn,nofootinbib,showkeys]{revtex4-1}
%\documentclass[aps,amssymb,prl,letterpaper,twocolumn,nofootinbib,showkeys]{revtex4-1}

%\usepackage[backend=bibtex]{biblatex}






%    backend=biber,
%    style=authoryear,
%    natbib=true,
%    sortlocale=en_US,
%    url=false,
%    doi=true,f
%    eprint=false
%]{biblatex}
%\usepackage{hyperref}


\newcommand{\mat}[1]{\boldsymbol{#1}}
\newcommand{\matT}[1]{\boldsymbol{#1}^\dagger}
\newcommand{\ot}[1]{ {\scriptstyle \otimes}_{ \tau } }



%%\hypersetup{pdftitle={FreeON Project Report 1}}
%\hypersetup{pdfauthor={Matt Challacombe and Nicolas Bock}}
%\hypersetup{pdfsubject={A SpAMM Stabilized Newton Schulz Preconditioner: Fighting Error with Error}}

%\bibstyle{aipnum4-1}

\begin{document}

\title{A SpAMM Stabilized Newton Schulz: Extreme Preconditioning}

\author{Matt Challacombe}
\email{matt.challacombe@freeon.org}
\homepage{http://www.freeon.org}
\affiliation{Theoretical Division, Los Alamos National Laboratory}

\author{Nicolas Bock}
\email{nicolasbock@freeon.org}
\homepage{http://www.freeon.org}
\affiliation{Theoretical Division, Los Alamos National Laboratory}

%\begin{abstract}
%Forward look
%\end{abstract}

\maketitle
\section{Introduction}


\paragraph{why do we care about  preconditioning} %%!what is spamm}

concerned with extending these incomplete algebras towards the approximations extreme of stability; how sloppy can our SpAMM be 
and still reliably gain the basin of convergence?.

\paragraph{generalized n-body methods}
single programing model.  generacity. 

\paragraph{the case for strong scaling}

\section{Overview of Functional Approximation}

with emphasis on the problem of the problem of electronic structure
Higham's identity

\subsection{Approximation with Incompleteness and Iteration: Corruption of the Eigen Basis}

\subsubsection{Incompleteness via Partial Inner Iteration}
Others ... 
\subsubsection{Incompleteness via Occlusion and Culling}

\paragraph{\bf Basis truncation (BCSR):}

\paragraph{\bf Occlusion by metric querry on Cauchy-Schwarz (SpAMM):}

\subsection{\bf Methods that accumulate incompleteness  (purification, and Krylov subspace):} 

\subsection{\bf ``Variational'' Methods Stay Close to the Basis (LNV Gradients, RQI and Newton Shulz)} 

\section{Accelerated Newton Shulz Iteration for the Inverse Square Root}

\section{SpAMM Stabilization of the Newton Shulz Iteration}

\subsection{\bf  SpAMM Leftovers are Deterministic}

\subsection{\bf  Stabilization of the Inverse Square Root Iteration}




\begin{equation}
\boldmath{\large \epsilon}_\perp = \left[ \tilde{\bm{x}},\tilde{\bm{x}}^\dagger  \right]
\end{equation}


\begin{eqnarray}
\widetilde{\mat{x}}_\text{n} &=& \mat{z} \, {\scriptstyle \otimes}_\tau  \left[  \mat{s} \,\,  {\scriptstyle \otimes}_\tau \, \mat{z}  \right] \\[0.1cm]
                    &=& \mat{z} \, {\scriptstyle \otimes}_\tau  \left[  \mat{s}\!\cdot \! \mat{z} + \mat{\delta}^{s,z}_\tau  \right] \\[0.1cm]
                    &=& \mat{x}_\text{n} + \mat{z} \cdot \mat{\delta}^{s,z}_\tau + \mat{\delta}^{z,\delta^{s,z}}_\tau 
 \end{eqnarray}




\begin{eqnarray}
\widetilde{\mat{x}}^\dagger_\text{n} &=& \matT{z} \, {\scriptstyle \otimes}_\tau  \left[  \mat{s} \,\,  {\scriptstyle \otimes}_\tau \, \matT{z}  \right] \\[0.1cm]
                    &=& \matT{z} \, {\scriptstyle \otimes}_\tau  \left[  \mat{s}\!\cdot \! \matT{z} + \mat{\delta}^{[sz^\dagger]}  \right] \\[0.1cm]
                    &=& \matT{x}_\text{n} + \matT{z} \cdot \mat{\delta}^{s,z^\dagger}_\tau + \mat{\delta}^{z^\dagger ,\delta^{s,z^\dagger}}_\tau 
 \end{eqnarray}


%\begin{eqnarray}
%\bm{\large \epsilon}^{\text{n}}_\perp \left(\bm{z}, \bm{s}, \tau \right) &=& test \\
%
%                              &=& \left[ \bm{x}+\bm{z}\cdot \bm{\delta}^{s,z}_{\tau} + \mathcal{O}(\tau^2) \, ,  \right. \\[0.1cm] 
%                                         && \qquad \left.  \bm{x}^\dagger +\bm{z}\cdot \bm{\delta}^{s,z}_{\tau} + \mathcal{O}(\tau^2)   \right]
%\end{eqnarray}

\begin{eqnarray}
\mat{\epsilon}^{\text{n}}_\perp \left(  \mat{z}, \mat{s}, \tau  \right)  &=& \left[ \tilde{\mat{x}}_\text{n},\tilde{\mat{x}}^\dagger_\text{n}  \right] \\
&=&\left[ \mat{x}+\mat{z}\cdot \mat{\delta}^{s,z}_{\tau} + \mathcal{O}(\tau^2) \, , \right.  \\ 
             && \qquad \left.  \mat{x}^\dagger +\mat{z}^\dagger \cdot \mat{\delta}^{s,z^\dagger}_{\tau} + \mathcal{O}(\tau^2)   \right] \nonumber \\[0.2cm] 
                    &=& \left[ \mat{x}_\text{n}, \matT{x}_\text{n} \right] +  \left[ \mat{x}_\text{n}, \mat{z}^\dagger \cdot \mat{\delta}^{s,z^\dagger}_{\tau} \right] \\
                    && \qquad + \left[  \mat{z}\cdot \mat{\delta}^{s,z}_{\tau} , \matT{x}_\text{n} \right] \, + \, \mathcal{O}(\tau^2)
 \end{eqnarray}

\pagebreak

%                    &=& \mat{x}_{\text{stab}} + \mat{\delta}^{z^\dagger [sz]} + \matT{z} \cdot \mat{\delta}^{[sz]} %+ \mathcal{O}( \tau^2  ) 


\begin{eqnarray}
\widetilde{\mat{x}}_{\text{stab}} &=& \matT{z} \, {\scriptstyle \otimes}_\tau  \left[  \mat{s} \,\,  {\scriptstyle \otimes}_\tau \, \mat{z}  \right] \\[0.1cm]
                    &=& \matT{z} \, {\scriptstyle \otimes}_\tau  \left[  \mat{s}\!\cdot \! \mat{z} + \mat{\delta}^{[sz]}  \right] \\[0.1cm]
                    &=& \mat{x} + \left(  \matT{z} \cdot \mat{\delta}^{[sz]} \right)  +  \mat{\delta}^{z^\dagger[sz]}  
%+ \mathcal{O}( \tau^2  ) 
\end{eqnarray}


\begin{eqnarray}
\widetilde{\mat{x}}_{\text{s}} &=& \matT{z} \, {\scriptstyle \otimes}_\tau  \left[  \mat{s} \,\,  {\scriptstyle \otimes}_\tau \, \mat{z}  \right] \\[0.1cm]
                    &=& \matT{z} \, {\scriptstyle \otimes}_\tau  \left[  \mat{s}\!\cdot \! \mat{z} + \mat{\delta}^{[sz]}  \right] \\[0.1cm]
                    &=& \mat{x} + \left(  \matT{z} \cdot \mat{\delta}^{[sz]} \right)  +  \mat{\delta}^{z^\dagger[sz]}  
%+ \mathcal{O}( \tau^2  ) 
\end{eqnarray}


\begin{eqnarray}
\widetilde{\mat{x}}^\dagger_{\text{s}} &=& \left\{ \matT{z} \, {\scriptstyle \otimes}_\tau  \left[  \mat{s} \,\,  {\scriptstyle \otimes}_\tau \, \mat{z}  \right] \right\}^\dagger \\[0.1cm]
                 &=& \left[  \mat{s}\!\cdot \! \mat{z} + \mat{\delta}^{[sz]}  \right]^\dagger  {\scriptstyle \otimes}_\tau \mat{z}  \\[0.1cm]
                 &=& \left[ \matT{z} \cdot  \mat{s} + \mat{\delta}^{[z^\dagger s]}  \right]{\scriptstyle \otimes}_\tau \mat{z}  \\[0.1cm]
                 &=&  \mat{x}_\text{s} + \mat{\delta}^{[ z^\dagger s ]} \cdot  \mat{z}  +  \mat{\delta}^{[z^\dagger s]z} \\[0.1cm]
                 &=&  \mat{x}_\text{s} + \left( \matT{z} \cdot \mat{\delta}^{[ s z ]}  \right)^\dagger  +  \mat{\delta}^{[z^\dagger s]z}
\end{eqnarray}

\begin{eqnarray}
\mat{\epsilon}^{\text{s}}_\perp \left(  \mat{z}, \mat{s}, \tau  \right)
                    &=& \left[ \mat{x}_\text{s} + \mat{z}\cdot \mat{\delta}^{s,z}_{\tau} + \mathcal{O}(\tau^2) \, , \right.  \\[0.1cm] 
             && \qquad \left.  \mat{x}^\dagger_s +\mat{z}^\dagger \cdot \bm{\delta}^{s,z^\dagger}_{\tau} + \mathcal{O}(\tau^2)   \right]
 \end{eqnarray}

\begin{eqnarray}
\mat{\epsilon}^{\text{s}}_\perp \left(  \mat{z}, \mat{s}, \tau  \right)  &=& \left[ \tilde{\mat{x}}_\text{s},\tilde{\mat{x}}^\dagger_\text{s}  \right] \\
&=&\left[ \mat{x}+\matT{z}\cdot \mat{\delta}^{s,z}_{\tau} + \mathcal{O}(\tau^2) \, , \right.  \\ 
             && \qquad \left.  \mat{x}^\dagger + \left( \mat{z}^\dagger \cdot \mat{\delta}^{s,z}_{\tau} \right)^\dagger + \mathcal{O}(\tau^2)   \right] \nonumber \\[0.2cm] 
                    &=& \left[ \mat{x}_\text{s}, \matT{x}_\text{s} \right] +  \left[ \mat{x}_\text{s}, 
\left( \mat{z}^\dagger \cdot \mat{\delta}^{s,z}_{\tau} \right)^\dagger \right] \\
                    && \qquad + \left[  \matT{z}\cdot \mat{\delta}^{s,z}_{\tau} , \matT{x}_\text{s} \right] \, + \, \mathcal{O}(\tau^2)
 \end{eqnarray}


\section{Stabilization of the Accelerated Map}


\section{Conclusion}

\paragraph{potential for data oriented  mathematics}
%%eg vs row-col picture.  Example of exact exchange w/DBSR 



\end{document}
