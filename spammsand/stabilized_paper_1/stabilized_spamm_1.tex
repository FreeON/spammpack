%% LyX 2.1.1 created this file.  For more info, see http://www.lyx.org/.
%% Do not edit unless you really know what you are doing.
%\documentclass[letterpaper,twocol,amsmath,aps,jcp,preprintnumbers,groupaddress,nofootinbib,tightenlines]{revtex4-1}
%\usepackage[latin9]{inputenc}
%\usepackage{textcomp}

\documentclass[letterpaper,twocolumn,amsmath,amsfont,amssymb,english,aps,jcp,preprintnumbers,groupaddress,nofootinbib,tightenlines]{revtex4}

%\documentclass[aps,prb,letterpaper,twocolumn,nofootinbib,showkeys]{revtex4-1}
%\documentclass[aps,amssymb,prl,letterpaper,twocolumn,nofootinbib,showkeys]{revtex4-1}

%\usepackage[backend=bibtex]{biblatex}

%    backend=biber,
%    style=authoryear,
%    natbib=true,
%    sortlocale=en_US,
%    url=false,
%    doi=true,f
%    eprint=false
%]{biblatex}
%\usepackage{hyperref}


\newcommand{\mat}[1]{\boldsymbol{#1}}
\newcommand{\matT}[1]{\boldsymbol{#1}^\dagger}
\newcommand{\ot}{ {\scriptstyle \otimes}_{ \tau } }

%%\hypersetup{pdftitle={FreeON Project Report 1}}
%\hypersetup{pdfauthor={Matt Challacombe and Nicolas Bock}}
%\hypersetup{pdfsubject={A SpAMM Stabilized Newton Schulz Preconditioner: Fighting Error with Error}}

%\bibstyle{aipnum4-1}

\begin{document}

\title{On Stability of the Newton Schulz Iteration in an Approximate Algebra}

\author{Matt Challacombe}
\email{matt.challacombe@freeon.org}
\homepage{http://www.freeon.org}
\affiliation{Theoretical Division, Los Alamos National Laboratory}

\author{Nicolas Bock}
\email{nicolasbock@freeon.org}
\homepage{http://www.freeon.org}
\affiliation{Theoretical Division, Los Alamos National Laboratory}

%\begin{abstract}
%Forward look
%\end{abstract}

\maketitle
\section{Introduction}

Decay principles, often very sparse but very ill-conditioned problems.

\subsection{Matrix Multiplication as N-Body Problem}
database orientation, Cauchy sch
Approximate Algebra, SpAMM Cauchy Schwarz occlusion, n-body approach to numerical linear algebra, first order errors in matrix multiplication.
Based on Cauchy Schwarz inequality.



\begin{equation}
\mat{a} \ot \mat{b} \equiv \mat{a}^0_{00} \ot \mat{b}^0_{00} 
\end{equation}

\begin{equation}
\mat{a}^l =  \mat{a}_{00} \ot \mat{b}_{00} 
\end{equation}

error accumulation may be better than row-col
single programing model.  generacity.  communication optimality and strong scaling.

\subsection{Incomplete Algorithms and Aproximate Algebras} %%!what is spamm}

Incompleteness -> sparse approximations dense problems, uses conventional sparse infrastructure, second order errors in matrix multiplication.  
Often adhoc.

Philosophy: Don't know which elements to drop, because only make sense in context.  It is very difficult to incorporate this context in a dropping 
strategies. 

Approximate Algebra, SpAMM Cauchy Schwarz occlusion, n-body approach to numerical linear algebra, first order errors in matrix multiplication.
Based on Cauchy Schwarz inequality.

\begin{equation}
\mat{a} \ot \mat{b}=\mat{a}\cdot \mat{b} + \mat{\Delta}^{a\cdot b}_{\tau}
\end{equation}
where $\mat{\Delta}_{\tau}$ is a deterministic first order variation , $\tau \, \widehat{\mat{\Delta}}$, cooresponding to the branch pattern set
by Cauchy-Schwarz culling.  
Because $\mat{\Delta}^{a\cdot b}_{\tau}$ is assymetric (even if $\mat{a}$ and $\mat{b}$ are symmetric and retain the same basis),  
SpAMM is non-associative, with Lie bracket
\begin{equation}
\left[ \mat{a} , \mat{b} \right]_{\tau} =
\mat{a} \ot \mat{b}-\mat{b} \ot \mat{a} = \mat{\Delta}^{a\cdot b}_{\tau} -\mat{\Delta}^{b\cdot a}_{\tau} .
\end{equation}
defining fields associated 
%
% SpAMM approximation introduces the vector field $ \sim \tau \left[\mat{\Delta}^{a\cdot b}_{\tau} -\mat{\Delta}^{b\cdot a}_{\tau}\right]/
%\lVert \mat{\Delta}^{a\cdot b}_{\tau} -\mat{\Delta}^{b\cdot a}_{\tau}] \rVert $.
Our interest is in minimizing change in these fields under iteration, for ill-conditioned problems and with permisive values of $\tau$. 

\subsection{On ``Variational'' and ``non-Variational'' Iteration}
Gradients lack convergence properties
Iteration without orig drives away from basis
NS has both.  Difference between scalar iteration, Higham page 92.

\subsection{\bf Methods that accumulate incompleteness  (purification, and Krylov subspace):} 

\subsection{\bf ``Variational'' Methods Stay Close to the Basis (LNV Gradients, RQI and Newton Shulz)} 
\subsection{Approximation with Incompleteness and Iteration: Corruption of the Eigen Basis}


\section{Newton Shulz Iteration}
\begin{multline}
\Delta \mat{x}_k = {f}_{\Delta \mat{z}_{k-1}}  \, \lVert \Delta \mat{z}_{k-1} \rVert 
                              +  {f}_{\Delta \mat{x}_{k-1}}   \, \lVert \Delta \mat{x}_{k-1} \rVert \\
                              +  {f}_{\Delta \mat{z}_{k-1}, \Delta \mat{x}_{k-1} }   \, \lVert \Delta \mat{z}_{k-1} \rVert
                                                                                      \, \lVert \Delta \mat{x}_{k-1} \rVert
                                                                                      + \cal{O} \left(  \tau^\rm{3} \right)
\end{multline}



\subsection{\bf  On the Boundedness of Idempotent Iteration}


\pagebreak

\subsection{\bf  Error Flows in Naive, Dual and Stable Newton Schulz Iterations}

\begin{equation}
\Delta \mat{x}^{\rm{naiv}}_k =   \Delta  \widetilde{ \mat{z}}_{k} \cdot \mat{s} \cdot \widetilde{\mat{z}}_{k} 
                           +  \widetilde{\mat{z}}_{k} \cdot \mat{s} \cdot \! \Delta \widetilde{\mat{z}}_{k} 
                         \end{equations}



\begin{equation}
\Delta \mat{x}^{\rm{dual}}_k =   \Delta  \widetilde{ \mat{y}}_{k} \cdot \widehat{\mat{z}}_{k} 
                           +  \widetilde{\mat{y}}_{k} \cdot \Delta \widetilde{\mat{z}}_{k} 
\end{equation}



\begin{eqnarray}
 \mat{x}_k \! \left( \mat{s} \right)&=& f \left[\mat{z}_{k-1}\!\left(\mat{s}\right), \mat{x}_{k-1}\!\left(\mat{s}\right), \mat{s} \left] 
\\ 
&=&
\tt{m} \left[ \mat{x}_{k-1}\!\left(\mat{s} \right)\right] 
                                    \cdot \mat{z}^\dagger_{k-1} \! \left( \mat{s} \right)
 \cdot \mat{s} \cdot \mat{z}_{k-1} \!\left( \mat{s} \right)  \cdot \tt{m}\left[ \mat{x}_{k-1} \!\left(\mat{s} \right)\right] 
\nonumber
\end{eqnarray}


\begin{multline}
\Delta \mat{x}_k = {f}_{\Delta \mat{z}_{k-1}}  \, \lVert \Delta \mat{z}_{k-1} \rVert 
                              +  {f}_{\Delta \mat{x}_{k-1}}   \, \lVert \Delta \mat{x}_{k-1} \rVert \\
                              +  {f}_{\Delta \mat{z}_{k-1}, \Delta \mat{x}_{k-1} }   \, \lVert \Delta \mat{z}_{k-1} \rVert
                                                                                      \, \lVert \Delta \mat{x}_{k-1} \rVert
                                                                                      + \cal{O} \left(  \tau^\rm{3} \right)
\end{multline}



generalized Gateaux differential


\begin{equation}
f_{\mat{\Delta}} = \lim_{\tau \rightarrow 0} \frac{ f [\, \mat{x} \, + \, \tau \widehat{\mat{\Delta}} \, ]-f\left[\mat{x}\right]}{\tau}  
\end{equation}


\begin{multline}
%%{f}_{\Delta \mat{z}_{k-1}}  
{L}_{\mat{x}_k}\left(\widetilde{\mat{z}}_{k} , \Delta \mat{z}_{k-1} \right) 
= 
\Delta {\mat{z}}^\dagger_{k-1}  \cdot \{\tt{m}\left[\mat{x}_{k-1} \right] 
 \cdot \mat{s}\} \cdot \widetilde{\mat{z}}_{k} \\
+\widetilde{\mat{z}}^\dagger_{k} \cdot \mat{s} \cdot \tt{m}\left[\mat{x}_{k-1} \right]  \cdot \left(\Delta {\mat{z}}_{k-1}  \right) 
\end{multline}


\begin{multline}
%{f}^{\rm{stab}}_{\Delta \mat{x}_{k-1}}  
{L}_{\mat{x}_k}\left(\widetilde{\mat{z}}_{k} , \Delta \mat{x}_{k-1} \right) 
= \Delta \widehat{\mat{x}}^\dagger_{k-1} \cdot \tt{m}'\left[\mat{x}_{k-1} \right]\cdot 
\{\widetilde{\mat{z}}^\dagger_{k-1}  \cdot \mat{s} \cdot \widetilde{\mat{z}}_{k} \}  \\
+ \{
\widetilde{\mat{z}}^\dagger_{k} \cdot \mat{s} \cdot  \widetilde{\mat{z}}_{k-1} \} \cdot \tt{m}'\left[\mat{x}_{k-1} \right]  
\cdot \Delta \widehat{\mat{x}}_{k-1} 
\end{multline}


\subsection{\bf  An Experiment}

\begin{equation}
\boldmath{\large \epsilon}_\perp\left(\mat{x}\right) = 
\frac{ \lVert \left[ \mat{s}, \mat{x} \right] \rVert  } { \lVert \mat{s}\rVert \lVert \mat{x} \rVert }
\end{equation}

\begin{equation}
\mat{z}_{k+1}  \leftarrow \mat{z}_k  \;  \cdot \; {m\!} \left( \mat{x}_k \right) \qquad
\end{equation}


\begin{equation}
\mat{x}_{k+1} \leftarrow \mat{z}_{k+1} \; \cdot \; {m \!} \left( \mat{x} \right) \; \cdot \; \mat{z}_{k+1} \qquad
\end{equation}


\begin{equation}
\widetilde {\mat{z}}_{k+1}  \leftarrow \mat{z}_{k}  \;  \ot \; {m\!} \left( \mat{x}_k \right) \qquad
\end{equation}


\begin{equation}
\widetilde {\mat{z}}_k = {\mat{z}}_k + \mat{\Delta}^\tau_k \qquad
\end{equation}


\begin{equation}
\lVert \mat{\Delta}^\tau_k  \rVert \sim \tau \lVert \mat{z}_k \rVert \lVert {m}\left(\mat{x}_k\right) \rVert \qquad
\end{equation}


\begin{equation}
\widetilde{\mat{x}}_{k+1} \leftarrow \widetilde{\mat{z}}_{k+1} \; \ot \; {m \!} \left( \mat{x}_k \right)\;  \ot \; \widetilde{\mat{z}}_{k+1} \qquad
\end{equation}

\begin{equation}
\widetilde {\mat{x}}_k = {\mat{x}}_k + \mat{\epsilon}^\tau_k \qquad
\end{equation}

\begin{equation}
\widetilde{\mat{x}}_{k+1} \leftarrow \left( \mat{z}_{k+1} +\mat{\Delta}_{k} \right) 
\; \ot \; {m \!} \left( \mat{x}_k \right)\;  \ot \; \left( \mat{z}_{k+1} + \mat{\Delta}_k \right) \qquad
\end{equation}


\begin{equation}
\widetilde{\mat{x}}^\text{stab}_{k+1} \leftarrow \left( \mat{z}^\dagger_{k+1} +\mat{\Delta}\dagger_{k} \right) 
\; \ot \; {m \!} \left( \mat{x}_k \right)\;  \ot \; \left( \mat{z}_{k+1} + \mat{\Delta}_k \right) \qquad
\end{equation}



\pagebreak




\begin{eqnarray}
\widetilde{\mat{x}}_\text{n} &=& \mat{z} \, {\scriptstyle \otimes}_\tau  \left[  \mat{s} \,\,  {\scriptstyle \otimes}_\tau \, \mat{z}  \right] \\[0.1cm]
                    &=& \mat{z} \, {\scriptstyle \otimes}_\tau  \left[  \mat{s}\!\cdot \! \mat{z} + \mat{\Delta}^{s,z}_\tau  \right] \\[0.1cm]
                    &=& \mat{x}_\text{n} + \mat{z} \cdot \mat{\Delta}^{s,z}_\tau + \mat{\Delta}^{z,\Delta^{s,z}}_\tau 
 \end{eqnarray}


\begin{eqnarray}
\widetilde{\mat{x}}^\dagger_\text{n} &=& \matT{z} \, {\scriptstyle \otimes}_\tau  \left[  \mat{s} \,\,  {\scriptstyle \otimes}_\tau \, \matT{z}  \right] \\[0.1cm]
                    &=& \matT{z} \, {\scriptstyle \otimes}_\tau  \left[  \mat{s}\!\cdot \! \matT{z} + \mat{\Delta}^{[sz^\dagger]}  \right] \\[0.1cm]
                    &=& \matT{x}_\text{n} + \matT{z} \cdot \mat{\Delta}^{s,z^\dagger}_\tau + \mat{\Delta}^{z^\dagger ,\Delta^{s,z^\dagger}}_\tau 
 \end{eqnarray}


%\begin{eqnarray}
%\bm{\large \epsilon}^{\text{n}}_\perp \left(\bm{z}, \bm{s}, \tau \right) &=& test \\
%
%                              &=& \left[ \bm{x}+\bm{z}\cdot \bm{\Delta}^{s,z}_{\tau} + \mathcal{O}(\tau^2) \, ,  \right. \\[0.1cm] 
%                                         && \qquad \left.  \bm{x}^\dagger +\bm{z}\cdot \bm{\Delta}^{s,z}_{\tau} + \mathcal{O}(\tau^2)   \right]
%\end{eqnarray}

\begin{eqnarray}
\mat{\epsilon}^{\text{n}}_\perp \left(  \mat{z}, \mat{s}, \tau  \right)  &=& \left[ \tilde{\mat{x}}_\text{n},\tilde{\mat{x}}^\dagger_\text{n}  \right] \\
&=&\left[ \mat{x}+\mat{z}\cdot \mat{\Delta}^{s,z}_{\tau} + \mathcal{O}(\tau^2) \, , \right.  \\ 
             && \qquad \left.  \mat{x}^\dagger +\mat{z}^\dagger \cdot \mat{\Delta}^{s,z^\dagger}_{\tau} + \mathcal{O}(\tau^2)   \right] \nonumber \\[0.2cm] 
                    &=& \left[ \mat{x}_\text{n}, \matT{x}_\text{n} \right] +  \left[ \mat{x}_\text{n}, \mat{z}^\dagger \cdot \mat{\Delta}^{s,z^\dagger}_{\tau} \right] \\
                    && \qquad + \left[  \mat{z}\cdot \mat{\Delta}^{s,z}_{\tau} , \matT{x}_\text{n} \right] \, + \, \mathcal{O}(\tau^2)
 \end{eqnarray}

\pagebreak

%                    &=& \mat{x}_{\text{stab}} + \mat{\Delta}^{z^\dagger [sz]} + \matT{z} \cdot \mat{\Delta}^{[sz]} %+ \mathcal{O}( \tau^2  ) 


\begin{eqnarray}
\widetilde{\mat{x}}_{\text{stab}} &=& \matT{z} \, {\scriptstyle \otimes}_\tau  \left[  \mat{s} \,\,  {\scriptstyle \otimes}_\tau \, \mat{z}  \right] \\[0.1cm]
                    &=& \matT{z} \, {\scriptstyle \otimes}_\tau  \left[  \mat{s}\!\cdot \! \mat{z} + \mat{\Delta}^{[sz]}  \right] \\[0.1cm]
                    &=& \mat{x} + \left(  \matT{z} \cdot \mat{\Delta}^{[sz]} \right)  +  \mat{\Delta}^{z^\dagger[sz]}  
%+ \mathcal{O}( \tau^2  ) 
\end{eqnarray}


\begin{eqnarray}
\widetilde{\mat{x}}_{\text{s}} &=& \matT{z} \, {\scriptstyle \otimes}_\tau  \left[  \mat{s} \,\,  {\scriptstyle \otimes}_\tau \, \mat{z}  \right] \\[0.1cm]
                    &=& \matT{z} \, {\scriptstyle \otimes}_\tau  \left[  \mat{s}\!\cdot \! \mat{z} + \mat{\Delta}^{[sz]}  \right] \\[0.1cm]
                    &=& \mat{x} + \left(  \matT{z} \cdot \mat{\Delta}^{[sz]} \right)  +  \mat{\Delta}^{z^\dagger[sz]}  
%+ \mathcal{O}( \tau^2  ) 
\end{eqnarray}


\begin{eqnarray}
\widetilde{\mat{x}}^\dagger_{\text{s}} &=& \left\{ \matT{z} \, {\scriptstyle \otimes}_\tau  \left[  \mat{s} \,\,  {\scriptstyle \otimes}_\tau \, \mat{z}  \right] \right\}^\dagger \\[0.1cm]
                 &=& \left[  \mat{s}\!\cdot \! \mat{z} + \mat{\Delta}^{[sz]}  \right]^\dagger  {\scriptstyle \otimes}_\tau \mat{z}  \\[0.1cm]
                 &=& \left[ \matT{z} \cdot  \mat{s} + \mat{\Delta}^{[z^\dagger s]}  \right]{\scriptstyle \otimes}_\tau \mat{z}  \\[0.1cm]
                 &=&  \mat{x}_\text{s} + \mat{\Delta}^{[ z^\dagger s ]} \cdot  \mat{z}  +  \mat{\Delta}^{[z^\dagger s]z} \\[0.1cm]
                 &=&  \mat{x}_\text{s} + \left( \matT{z} \cdot \mat{\Delta}^{[ s z ]}  \right)^\dagger  +  \mat{\Delta}^{[z^\dagger s]z}
\end{eqnarray}

\begin{eqnarray}
\mat{\epsilon}^{\text{s}}_\perp \left(  \mat{z}, \mat{s}, \tau  \right)
                    &=& \left[ \mat{x}_\text{s} + \mat{z}\cdot \mat{\Delta}^{s,z}_{\tau} + \mathcal{O}(\tau^2) \, , \right.  \\[0.1cm] 
             && \qquad \left.  \mat{x}^\dagger_s +\mat{z}^\dagger \cdot \bm{\Delta}^{s,z^\dagger}_{\tau} + \mathcal{O}(\tau^2)   \right]
 \end{eqnarray}

\begin{eqnarray}
\mat{\epsilon}^{\text{s}}_\perp \left(  \mat{z}, \mat{s}, \tau  \right)  &=& \left[ \tilde{\mat{x}}_\text{s},\tilde{\mat{x}}^\dagger_\text{s}  \right] \\
&=&\left[ \mat{x}+\matT{z}\cdot \mat{\Delta}^{s,z}_{\tau} + \mathcal{O}(\tau^2) \, , \right.  \\ 
             && \qquad \left.  \mat{x}^\dagger + \left( \mat{z}^\dagger \cdot \mat{\Delta}^{s,z}_{\tau} \right)^\dagger + \mathcal{O}(\tau^2)   \right] \nonumber \\[0.2cm] 
                    &=& \left[ \mat{x}_\text{s}, \matT{x}_\text{s} \right] +  \left[ \mat{x}_\text{s}, 
\left( \mat{z}^\dagger \cdot \mat{\Delta}^{s,z}_{\tau} \right)^\dagger \right] \\
                    && \qquad + \left[  \matT{z}\cdot \mat{\Delta}^{s,z}_{\tau} , \matT{x}_\text{s} \right] \, + \, \mathcal{O}(\tau^2)
 \end{eqnarray}


\section{Stabilization of the Accelerated Map}


\section{Conclusion}

\paragraph{potential for data oriented  mathematics}
%%eg vs row-col picture.  Example of exact exchange w/DBSR 



\end{document}
